{
  "title": "[perf] 月別集計APIのN+1問題を解消 - cardIdパラメータ対応",
  "labels": ["enhancement", "priority: high", "size: M", "backend", "api"],
  "body": "## 概要\n\nクレジットカード管理画面で月別サマリーを取得する際に、N+1問題が発生しています。現在は`aggregationApi.getAll()`で全サマリーを取得した後、各サマリーの詳細を`aggregationApi.getById()`で個別に取得しているため、サマリーの数に比例してAPIリクエストが増加し、パフォーマンスが大幅に低下する可能性があります。\n\n## 問題点\n\n**現在の実装（フロントエンド）**:\n\n```typescript\n// ❌ N+1問題: リスト取得後に各アイテムの詳細を個別に取得\nconst summaries = await aggregationApi.getAll();\nconst cardSummaries = summaries\n  .filter((s) => s.cardId === selectedCardId)\n  .map(async (s) => {\n    const detail = await aggregationApi.getById(s.id); // N回のAPIコール\n    return detail;\n  });\nconst results = await Promise.all(cardSummaries);\n```\n\n**問題**:\n- サマリーの数に比例してAPIリクエストが増加\n- ネットワーク遅延の累積\n- パフォーマンスの大幅な低下\n\n## 対応方針\n\nバックエンドAPIに、特定のカードIDに関連する詳細な月別サマリーを一度に取得できるエンドポイントを追加します。\n\n### バックエンドAPI追加\n\n**エンドポイント**: `GET /api/aggregation/card/monthly/card/:cardId`\n\n**レスポンス**: 指定されたカードIDに関連する月別サマリーの詳細情報を配列で返却\n\n### フロントエンド修正\n\n```typescript\n// ✅ 1回のAPIコールで必要なデータをすべて取得\nconst summaries = await aggregationApi.getByCardId(selectedCardId);\n```\n\n## 作業内容\n\n- [ ] バックエンドAPIエンドポイントの実装\n  - [ ] Controller追加\n  - [ ] UseCase実装\n  - [ ] Repositoryメソッド追加\n- [ ] フロントエンドAPIクライアントの修正\n  - [ ] `aggregationApi.getByCardId()`メソッド追加\n- [ ] フロントエンドコンポーネントの修正\n  - [ ] `CreditCardManagementPage.tsx`の修正\n- [ ] テスト追加\n  - [ ] バックエンドユニットテスト\n  - [ ] フロントエンドユニットテスト\n  - [ ] E2Eテスト\n\n## 参考\n\n- PR #304 - Geminiレビュー指摘\n- Issue #113 - クレジットカード管理画面の実装\n- `.cursor/rules/02-code-standards.md` セクション18.1 - フロントエンド側のN+1問題"
}
