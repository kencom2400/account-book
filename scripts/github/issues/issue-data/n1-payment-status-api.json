{
  "title": "[perf] 支払いステータスAPIのN+1問題を解消 - 一括取得エンドポイント追加",
  "labels": ["enhancement", "priority: high", "size: M", "backend", "api"],
  "body": "## 概要\n\nクレジットカード管理画面のステータス管理タブで、複数の月別サマリーのステータスを取得する際に、N+1問題が発生しています。現在は`monthlySummaries`をループして、各サマリーのステータスを`paymentStatusApi.getStatus()`で個別に取得しているため、サマリーの数に比例してAPIリクエストが増加し、パフォーマンスが低下します。\n\n## 問題点\n\n**現在の実装（フロントエンド）**:\n\n```typescript\n// ❌ N+1問題: 各サマリーのステータスを個別に取得\nfor (const summary of monthlySummaries) {\n  const status = await paymentStatusApi.getStatus(summary.id); // N回のAPIコール\n  records.set(summary.id, status);\n}\n```\n\n**問題**:\n- サマリーの数に比例してAPIリクエストが増加\n- ネットワーク遅延の累積\n- パフォーマンスの低下\n\n## 対応方針\n\nバックエンドAPIに、複数のサマリーIDを一度に受け取り、それらのステータスをまとめて返すエンドポイントを追加します。\n\n### バックエンドAPI追加\n\n**エンドポイント**: `GET /api/payment-status?summaryIds=id1,id2,id3`\n\n**リクエストパラメータ**:\n- `summaryIds`: カンマ区切りのサマリーIDリスト\n\n**レスポンス**: 指定されたサマリーIDに対応するステータス記録の配列\n\n### フロントエンド修正\n\n```typescript\n// ✅ 1回のAPIコールで必要なデータをすべて取得\nconst summaryIds = monthlySummaries.map((s) => s.id);\nconst statusRecords = await paymentStatusApi.getStatuses(summaryIds);\n```\n\n## 作業内容\n\n- [ ] バックエンドAPIエンドポイントの実装\n  - [ ] Controller追加\n  - [ ] UseCase実装\n  - [ ] Repositoryメソッド追加（一括取得）\n- [ ] フロントエンドAPIクライアントの修正\n  - [ ] `paymentStatusApi.getStatuses()`メソッド追加\n- [ ] フロントエンドコンポーネントの修正\n  - [ ] `StatusTab.tsx`の修正\n- [ ] テスト追加\n  - [ ] バックエンドユニットテスト\n  - [ ] フロントエンドユニットテスト\n  - [ ] E2Eテスト\n\n## 参考\n\n- PR #304 - Geminiレビュー指摘\n- Issue #113 - クレジットカード管理画面の実装\n- `.cursor/rules/02-code-standards.md` セクション18.1 - フロントエンド側のN+1問題"
}
