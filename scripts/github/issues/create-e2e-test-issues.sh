#!/bin/bash

# E2Eãƒ†ã‚¹ãƒˆä¸è¶³åˆ†ã®Issueä½œæˆã‚¹ã‚¯ãƒªãƒ—ãƒˆ

set -e

# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆã«ç§»å‹•
SCRIPT_DIR="$(cd "$(dirname "$0")" && pwd)"
PROJECT_ROOT="$(cd "$SCRIPT_DIR/../../.." && pwd)"
cd "$PROJECT_ROOT"

ISSUE_DATA_DIR="$PROJECT_ROOT/scripts/github/issues/issue-data/drafts/e2e-tests"
CREATE_ISSUE_SCRIPT="$PROJECT_ROOT/scripts/github/issues/create-issue.sh"

# ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä½œæˆ
mkdir -p "$ISSUE_DATA_DIR"

# Issueãƒ‡ãƒ¼ã‚¿ã®å®šç¾©ï¼ˆJSONå½¢å¼ï¼‰
declare -a ISSUES=(
'{"fr":"FR-001","title":"[testing] E2Eãƒ†ã‚¹ãƒˆ: FR-001 éŠ€è¡Œå£åº§ã¨ã®é€£æº","desc":"éŠ€è¡Œå£åº§ã¨ã®é€£æºæ©Ÿèƒ½ã®E2Eãƒ†ã‚¹ãƒˆã‚’å®Ÿè£…ã™ã‚‹"}'
'{"fr":"FR-002","title":"[testing] E2Eãƒ†ã‚¹ãƒˆ: FR-002 ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆã‚«ãƒ¼ãƒ‰ã¨ã®é€£æº","desc":"ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆã‚«ãƒ¼ãƒ‰ã¨ã®é€£æºæ©Ÿèƒ½ã®E2Eãƒ†ã‚¹ãƒˆã‚’å®Ÿè£…ã™ã‚‹"}'
'{"fr":"FR-003","title":"[testing] E2Eãƒ†ã‚¹ãƒˆ: FR-003 è¨¼åˆ¸ä¼šç¤¾ã¨ã®é€£æº","desc":"è¨¼åˆ¸ä¼šç¤¾ã¨ã®é€£æºæ©Ÿèƒ½ã®E2Eãƒ†ã‚¹ãƒˆã‚’å®Ÿè£…ã™ã‚‹"}'
'{"fr":"FR-004","title":"[testing] E2Eãƒ†ã‚¹ãƒˆ: FR-004 ã‚¢ãƒ—ãƒªèµ·å‹•æ™‚ã®ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰æŽ¥ç¶šç¢ºèª","desc":"ã‚¢ãƒ—ãƒªèµ·å‹•æ™‚ã®ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰æŽ¥ç¶šç¢ºèªæ©Ÿèƒ½ã®E2Eãƒ†ã‚¹ãƒˆã‚’å®Ÿè£…ã™ã‚‹"}'
'{"fr":"FR-005","title":"[testing] E2Eãƒ†ã‚¹ãƒˆ: FR-005 æŽ¥ç¶šå¤±æ•—æ™‚ã®ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—é€šçŸ¥","desc":"æŽ¥ç¶šå¤±æ•—æ™‚ã®ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—é€šçŸ¥æ©Ÿèƒ½ã®E2Eãƒ†ã‚¹ãƒˆã‚’å®Ÿè£…ã™ã‚‹"}'
'{"fr":"FR-006","title":"[testing] E2Eãƒ†ã‚¹ãƒˆ: FR-006 å„é‡‘èžæ©Ÿé–¢ã‹ã‚‰åˆ©ç”¨å±¥æ­´ã‚’è‡ªå‹•å–å¾—","desc":"å„é‡‘èžæ©Ÿé–¢ã‹ã‚‰åˆ©ç”¨å±¥æ­´ã‚’è‡ªå‹•å–å¾—æ©Ÿèƒ½ã®E2Eãƒ†ã‚¹ãƒˆã‚’å®Ÿè£…ã™ã‚‹"}'
'{"fr":"FR-007","title":"[testing] E2Eãƒ†ã‚¹ãƒˆ: FR-007 å–å¾—ãƒ‡ãƒ¼ã‚¿ã®ãƒ­ãƒ¼ã‚«ãƒ«ä¿å­˜","desc":"å–å¾—ãƒ‡ãƒ¼ã‚¿ã®ãƒ­ãƒ¼ã‚«ãƒ«ä¿å­˜æ©Ÿèƒ½ã®E2Eãƒ†ã‚¹ãƒˆã‚’å®Ÿè£…ã™ã‚‹"}'
'{"fr":"FR-011","title":"[testing] E2Eãƒ†ã‚¹ãƒˆ: FR-011 è²»ç›®ã®è¿½åŠ ãƒ»ç·¨é›†ãƒ»å‰Šé™¤æ©Ÿèƒ½","desc":"è²»ç›®ã®è¿½åŠ ãƒ»ç·¨é›†ãƒ»å‰Šé™¤æ©Ÿèƒ½ã®E2Eãƒ†ã‚¹ãƒˆã‚’å®Ÿè£…ã™ã‚‹"}'
'{"fr":"FR-012","title":"[testing] E2Eãƒ†ã‚¹ãƒˆ: FR-012 ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆã‚«ãƒ¼ãƒ‰åˆ©ç”¨æ˜Žç´°ã®æœˆåˆ¥é›†è¨ˆ","desc":"ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆã‚«ãƒ¼ãƒ‰åˆ©ç”¨æ˜Žç´°ã®æœˆåˆ¥é›†è¨ˆæ©Ÿèƒ½ã®E2Eãƒ†ã‚¹ãƒˆã‚’å®Ÿè£…ã™ã‚‹"}'
'{"fr":"FR-013","title":"[testing] E2Eãƒ†ã‚¹ãƒˆ: FR-013 éŠ€è¡Œå¼•è½é¡ã¨ã®è‡ªå‹•ç…§åˆæ©Ÿèƒ½","desc":"éŠ€è¡Œå¼•è½é¡ã¨ã®è‡ªå‹•ç…§åˆæ©Ÿèƒ½ã®E2Eãƒ†ã‚¹ãƒˆã‚’å®Ÿè£…ã™ã‚‹"}'
'{"fr":"FR-014","title":"[testing] E2Eãƒ†ã‚¹ãƒˆ: FR-014 æ”¯æ‰•ã„ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ç®¡ç†","desc":"æ”¯æ‰•ã„ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ç®¡ç†æ©Ÿèƒ½ã®E2Eãƒ†ã‚¹ãƒˆã‚’å®Ÿè£…ã™ã‚‹"}'
'{"fr":"FR-015","title":"[testing] E2Eãƒ†ã‚¹ãƒˆ: FR-015 ä¸ä¸€è‡´æ™‚ã®ã‚¢ãƒ©ãƒ¼ãƒˆè¡¨ç¤º","desc":"ä¸ä¸€è‡´æ™‚ã®ã‚¢ãƒ©ãƒ¼ãƒˆè¡¨ç¤ºæ©Ÿèƒ½ã®E2Eãƒ†ã‚¹ãƒˆã‚’å®Ÿè£…ã™ã‚‹"}'
'{"fr":"FR-017","title":"[testing] E2Eãƒ†ã‚¹ãƒˆ: FR-017 é‡‘èžæ©Ÿé–¢åˆ¥ã®é›†è¨ˆ","desc":"é‡‘èžæ©Ÿé–¢åˆ¥ã®é›†è¨ˆæ©Ÿèƒ½ã®E2Eãƒ†ã‚¹ãƒˆã‚’å®Ÿè£…ã™ã‚‹"}'
'{"fr":"FR-018","title":"[testing] E2Eãƒ†ã‚¹ãƒˆ: FR-018 ã‚«ãƒ†ã‚´ãƒªåˆ¥ã®é›†è¨ˆ","desc":"ã‚«ãƒ†ã‚´ãƒªåˆ¥ã®é›†è¨ˆæ©Ÿèƒ½ã®E2Eãƒ†ã‚¹ãƒˆã‚’å®Ÿè£…ã™ã‚‹"}'
'{"fr":"FR-019","title":"[testing] E2Eãƒ†ã‚¹ãƒˆ: FR-019 è²»ç›®åˆ¥ã®é›†è¨ˆ","desc":"è²»ç›®åˆ¥ã®é›†è¨ˆæ©Ÿèƒ½ã®E2Eãƒ†ã‚¹ãƒˆã‚’å®Ÿè£…ã™ã‚‹"}'
'{"fr":"FR-021","title":"[testing] E2Eãƒ†ã‚¹ãƒˆ: FR-021 ã‚¤ãƒ™ãƒ³ãƒˆãƒ¡ãƒ¢æ©Ÿèƒ½","desc":"ã‚¤ãƒ™ãƒ³ãƒˆãƒ¡ãƒ¢æ©Ÿèƒ½ã®E2Eãƒ†ã‚¹ãƒˆã‚’å®Ÿè£…ã™ã‚‹"}'
'{"fr":"FR-022","title":"[testing] E2Eãƒ†ã‚¹ãƒˆ: FR-022 ã‚¤ãƒ™ãƒ³ãƒˆã¨åŽæ”¯ã®ç´ä»˜ã‘","desc":"ã‚¤ãƒ™ãƒ³ãƒˆã¨åŽæ”¯ã®ç´ä»˜ã‘æ©Ÿèƒ½ã®E2Eãƒ†ã‚¹ãƒˆã‚’å®Ÿè£…ã™ã‚‹"}'
'{"fr":"FR-023","title":"[testing] E2Eãƒ†ã‚¹ãƒˆ: FR-023 æœˆé–“åŽæ”¯ã®ã‚°ãƒ©ãƒ•è¡¨ç¤º","desc":"æœˆé–“åŽæ”¯ã®ã‚°ãƒ©ãƒ•è¡¨ç¤ºæ©Ÿèƒ½ã®E2Eãƒ†ã‚¹ãƒˆã‚’å®Ÿè£…ã™ã‚‹"}'
'{"fr":"FR-025","title":"[testing] E2Eãƒ†ã‚¹ãƒˆ: FR-025 ã‚«ãƒ†ã‚´ãƒªåˆ¥å††ã‚°ãƒ©ãƒ•è¡¨ç¤º","desc":"ã‚«ãƒ†ã‚´ãƒªåˆ¥å††ã‚°ãƒ©ãƒ•è¡¨ç¤ºæ©Ÿèƒ½ã®E2Eãƒ†ã‚¹ãƒˆã‚’å®Ÿè£…ã™ã‚‹"}'
'{"fr":"FR-026","title":"[testing] E2Eãƒ†ã‚¹ãƒˆ: FR-026 é‡‘èžæ©Ÿé–¢åˆ¥è³‡ç”£æ®‹é«˜ã®è¡¨ç¤º","desc":"é‡‘èžæ©Ÿé–¢åˆ¥è³‡ç”£æ®‹é«˜ã®è¡¨ç¤ºæ©Ÿèƒ½ã®E2Eãƒ†ã‚¹ãƒˆã‚’å®Ÿè£…ã™ã‚‹"}'
'{"fr":"FR-027","title":"[testing] E2Eãƒ†ã‚¹ãƒˆ: FR-027 åŽæ”¯æŽ¨ç§»ã®ãƒˆãƒ¬ãƒ³ãƒ‰è¡¨ç¤º","desc":"åŽæ”¯æŽ¨ç§»ã®ãƒˆãƒ¬ãƒ³ãƒ‰è¡¨ç¤ºæ©Ÿèƒ½ã®E2Eãƒ†ã‚¹ãƒˆã‚’å®Ÿè£…ã™ã‚‹"}'
'{"fr":"FR-028","title":"[testing] E2Eãƒ†ã‚¹ãƒˆ: FR-028 é‡‘èžæ©Ÿé–¢æŽ¥ç¶šè¨­å®šã®ç”»é¢ç®¡ç†","desc":"é‡‘èžæ©Ÿé–¢æŽ¥ç¶šè¨­å®šã®ç”»é¢ç®¡ç†æ©Ÿèƒ½ã®E2Eãƒ†ã‚¹ãƒˆã‚’å®Ÿè£…ã™ã‚‹"}'
'{"fr":"FR-029","title":"[testing] E2Eãƒ†ã‚¹ãƒˆ: FR-029 èªè¨¼æƒ…å ±ã®ç™»éŒ²ãƒ»æ›´æ–°ãƒ»å‰Šé™¤","desc":"èªè¨¼æƒ…å ±ã®ç™»éŒ²ãƒ»æ›´æ–°ãƒ»å‰Šé™¤æ©Ÿèƒ½ã®E2Eãƒ†ã‚¹ãƒˆã‚’å®Ÿè£…ã™ã‚‹"}'
'{"fr":"FR-030","title":"[testing] E2Eãƒ†ã‚¹ãƒˆ: FR-030 ãƒ‡ãƒ¼ã‚¿åŒæœŸé–“éš”ã®è¨­å®š","desc":"ãƒ‡ãƒ¼ã‚¿åŒæœŸé–“éš”ã®è¨­å®šæ©Ÿèƒ½ã®E2Eãƒ†ã‚¹ãƒˆã‚’å®Ÿè£…ã™ã‚‹"}'
)

echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo "   ðŸ“‹ E2Eãƒ†ã‚¹ãƒˆä¸è¶³åˆ†ã®Issueä½œæˆ"
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""
echo "ä½œæˆäºˆå®šIssueæ•°: ${#ISSUES[@]}"
echo ""

# å„Issueã®JSONãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ
for i in "${!ISSUES[@]}"; do
    ISSUE_DATA="${ISSUES[$i]}"
    FR=$(echo "$ISSUE_DATA" | jq -r '.fr')
    TITLE=$(echo "$ISSUE_DATA" | jq -r '.title')
    DESC=$(echo "$ISSUE_DATA" | jq -r '.desc')
    
    # JSONãƒ•ã‚¡ã‚¤ãƒ«åï¼ˆå°æ–‡å­—ã«å¤‰æ›ï¼‰
    FR_LOWER=$(echo "$FR" | tr '[:upper:]' '[:lower:]')
    JSON_FILE="$ISSUE_DATA_DIR/${FR_LOWER}.json"
    
    # JSONãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ
    cat > "$JSON_FILE" << EOF
{
  "title": "$TITLE",
  "labels": [
    "testing",
    "frontend",
    "priority: medium",
    "size: M"
  ],
  "body": "**Epic**: #192 - ãƒ†ã‚¹ãƒˆå®Ÿè£…\\n\\n---\\n\\n## ðŸ“‹ æ¦‚è¦\\n\\n$DESC\\n\\n## ðŸŽ¯ ç›®çš„\\n\\næ©Ÿèƒ½è¦ä»¶ $FR ã«å¯¾ã™ã‚‹E2Eãƒ†ã‚¹ãƒˆã‚’å®Ÿè£…ã—ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ãƒ­ãƒ¼ã®å‹•ä½œã‚’ä¿è¨¼ã—ã¾ã™ã€‚\\n\\n## âœ… Acceptance Criteriaï¼ˆå—å…¥åŸºæº–ï¼‰\\n- [ ] E2Eãƒ†ã‚¹ãƒˆãŒå®Ÿè£…ã•ã‚Œã¦ã„ã‚‹\\n- [ ] æ­£å¸¸ç³»ã®å‹•ä½œãŒç¢ºèªã§ãã¦ã„ã‚‹\\n- [ ] ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãŒé©åˆ‡ã«å®Ÿè£…ã•ã‚Œã¦ã„ã‚‹\\n- [ ] ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆãŒãƒ‘ã‚¹ã—ã¦ã„ã‚‹\\n\\n## ðŸ“‹ Definition of Doneï¼ˆå®Œäº†å®šç¾©ï¼‰\\n\\n### ã‚³ãƒ¼ãƒ‰å“è³ª\\n- [ ] å®Ÿè£…ãŒå®Œäº†ã—ã¦ã„ã‚‹\\n- [ ] ã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼ãŒå®Œäº†ã—ã¦ã„ã‚‹\\n- [ ] ESLint/Prettierã‚¨ãƒ©ãƒ¼ãŒãªã„\\n- [ ] TypeScriptåž‹å®šç¾©ãŒé©åˆ‡ã«è¨­å®šã•ã‚Œã¦ã„ã‚‹\\n\\n### ãƒ†ã‚¹ãƒˆ\\n- [ ] E2Eãƒ†ã‚¹ãƒˆãŒæ›¸ã‹ã‚Œã¦ã„ã‚‹\\n- [ ] ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆãŒãƒ‘ã‚¹ã—ã¦ã„ã‚‹\\n- [ ] ã‚¨ãƒƒã‚¸ã‚±ãƒ¼ã‚¹ã®ãƒ†ã‚¹ãƒˆãŒå«ã¾ã‚Œã¦ã„ã‚‹\\n\\n### ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ\\n- [ ] ã‚³ãƒ¼ãƒ‰ã«ã‚³ãƒ¡ãƒ³ãƒˆãŒé©åˆ‡ã«è¨˜è¼‰ã•ã‚Œã¦ã„ã‚‹\\n\\n## ðŸ“ é–¢é€£ãƒ•ã‚¡ã‚¤ãƒ«\\n- å®Ÿè£…æ™‚ã«è¿½è¨˜\\n\\n## ðŸ“š å‚è€ƒè³‡æ–™\\n- \`docs/requirements-specification.md\`\\n- \`docs/functional-requirements/\`\\n- \`apps/frontend/e2e/\`\\n\\n## ðŸ’¡ å®Ÿè£…ãƒ¡ãƒ¢\\n- å®Ÿè£…é–‹å§‹æ™‚ã«è©³ç´°ã‚’è¿½è¨˜ã—ã¦ãã ã•ã„\\n- æŠ€è¡“çš„ãªèª²é¡Œã‚„æ±ºå®šäº‹é …ã‚’ã“ã“ã«è¨˜éŒ²ã—ã¾ã™"
}
EOF
    
    echo "âœ… $FR ã®Issueãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ: $JSON_FILE"
done

echo ""
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo "   ðŸ“ Issueä½œæˆ"
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""

# å„Issueã‚’ä½œæˆ
for JSON_FILE in "$ISSUE_DATA_DIR"/*.json; do
    if [ -f "$JSON_FILE" ]; then
        echo "ðŸ“‹ Issueä½œæˆä¸­: $(basename "$JSON_FILE")"
        "$CREATE_ISSUE_SCRIPT" "$JSON_FILE"
        echo ""
    fi
done

echo "âœ… ã™ã¹ã¦ã®Issueä½œæˆãŒå®Œäº†ã—ã¾ã—ãŸ"
