# プロジェクト概要

## ⚠️ AIアシスタントへの重要指示（最優先）

### 型安全性の絶対遵守

**このプロジェクトでは型安全性を最優先します。以下のルールを絶対に守ってください。**

1. **any型は絶対に使用しない**
   - ❌ 「とりあえずany型で」は厳禁
   - ✅ 型が不明な場合は`unknown`を使用
   - ✅ 適切な型定義・インターフェースを作成
   - ✅ ジェネリクスを活用

2. **エラー・警告を握りつぶさない**
   - ❌ ESLintエラーを`eslint-disable`で無効化しない
   - ❌ 警告を`warn`レベルに変更して隠さない
   - ❌ `@ts-ignore`で型エラーを無視しない
   - ✅ **根本原因を修正する**
   - ✅ やむを得ない場合は詳細なコメント（なぜ・いつまで・どうすれば）を必須化

3. **実装時の必須確認**
   - コード変更後は必ず`lint`と`build`を実行
   - エラー・警告が出たら、コミット前に**必ず修正**
   - テストコードも型安全性を守る（テストだからanyで良い、は誤り）

**違反例を提案した場合、ユーザーから指摘されます。必ず守ってください。**

## プロジェクト概要

金融機関APIを使用した個人資産管理アプリケーション。取引履歴の自動取得、カテゴリ分類、月次集計機能を提供する。

## データモデル

### 取引カテゴリ

5つの基本分類を必ず守る：

1. **収入**: 資産増加（給与、賞与、配当など）
2. **支出**: 資産減少（生活費、娯楽費など）
3. **振替**: 資産間移動（銀行→証券、クレカ引き落としなど）
4. **返済**: ローン・借入の返済
5. **投資**: 投資商品の購入・売却

### クレジットカード管理

- 支出計上: カード明細取得時に「支出」として記録
- 引き落とし: 銀行引き落としは「振替」として記録
- 月次突合: カード支払い額と銀行引き落とし額を比較
- ステータス管理: 未支払い/支払済を明確に区別

### データ永続化

- 初期: JSON形式で保存
- 将来: SQLiteまたはRDBMSへの移行を想定した設計

## 機能要件

### 金融機関API連携

- 各金融機関の接続設定をUI上で管理
- アプリ起動時にバックグラウンドで接続確認
- 接続失敗時はポップアップで通知
- APIクライアントは抽象化し、金融機関ごとに実装を切り替え可能に

### 分類・カテゴリ

- MoneyTree、MoneyForwardの分類を参考
- ユーザーによる分類の手動修正を可能に
- デフォルト分類ルールの学習機能（将来実装）

### 集計機能

- 月次集計: 金融機関別、分類別
- 期間指定での集計
- グラフ・チャートでの可視化

## セキュリティ

- 金融機関の認証情報は環境変数で管理
- APIキー、パスワードはGitにコミットしない
- 通信は必ずHTTPSを使用
- データは暗号化して保存（将来対応）

## テスト戦略

- ユニットテスト: 各レイヤごとに実装
- 統合テスト: API連携部分
- E2Eテスト: 重要なユーザーフロー
- テストカバレッジ: 80%以上を目標

## 注意事項

- 金融データの取り扱いには細心の注意を払う
- パフォーマンスを考慮し、大量データの処理は非同期で実装
- エラーハンドリングは必ず実装し、ユーザーにわかりやすいメッセージを表示
- ログは詳細に記録し、トラブルシューティングを容易にする

## 推奨ライブラリ

- バリデーション: `zod` または `class-validator`
- 日付処理: `dayjs` または `date-fns`
- HTTP通信: `axios`
- 状態管理（frontend）: `zustand` または `jotai`
- UIコンポーネント: `shadcn/ui` または `Chakra UI`

## 開発フロー

1. 要件定義 → ドメインモデル設計
2. ドメイン層から実装開始（内側→外側）
3. ユースケース実装
4. インフラ層実装（API接続、データ永続化）
5. プレゼンテーション層実装
6. テスト実装
7. レビュー・リファクタリング
