# CI/CDè¨­å®šã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³

## åŸºæœ¬åŸå‰‡

- **CI/CDè¨­å®šã¯å¸¸ã«ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã§ã‚‚å†ç¾å¯èƒ½ã§ã‚ã‚‹ã“ã¨**
- **ç’°å¢ƒå¤‰æ•°ã®ç®¡ç†ã¯æ˜ç¤ºçš„ã‹ã¤å®‰å…¨ã§ã‚ã‚‹ã“ã¨**
- **ãƒ†ã‚¹ãƒˆå®Ÿè¡Œã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯å …ç‰¢ã§ã€ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãŒé©åˆ‡ã§ã‚ã‚‹ã“ã¨**
- **ãƒãƒ¼ãƒˆç«¶åˆã‚„ãƒªã‚½ãƒ¼ã‚¹ç«¶åˆã‚’é¿ã‘ã‚‹è¨­è¨ˆã§ã‚ã‚‹ã“ã¨**
- **YAMLã®é‡è¤‡ã¯å¯èƒ½ãªé™ã‚Šã‚¢ãƒ³ã‚«ãƒ¼æ©Ÿèƒ½ã§å‰Šæ¸›ã™ã‚‹ã“ã¨**
- **ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¨å®Ÿè£…ã®æ•´åˆæ€§ã‚’å¸¸ã«ä¿ã¤ã“ã¨**

## ãƒ†ã‚¹ãƒˆå®Ÿè¡Œã‚¹ã‚¯ãƒªãƒ—ãƒˆã®è¨­è¨ˆåŸå‰‡

### ã‚µãƒ¼ãƒãƒ¼èµ·å‹•å¾…æ©Ÿå‡¦ç†

**âŒ æ‚ªã„ä¾‹ï¼ˆå›ºå®šsleepï¼‰:**

```bash
# å›ºå®šã®å¾…æ©Ÿæ™‚é–“ã¯ä¸ç¢ºå®Ÿ
pnpm dev &
sleep 5  # ã‚µãƒ¼ãƒãƒ¼ãŒèµ·å‹•ã—ã¦ã„ãªã„å¯èƒ½æ€§ãŒã‚ã‚‹
```

**âœ… è‰¯ã„ä¾‹ï¼ˆãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ãƒ™ãƒ¼ã‚¹ï¼‰:**

```bash
# ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ã§ã‚µãƒ¼ãƒãƒ¼ã®èµ·å‹•ã‚’ç¢ºèª
pnpm dev > /tmp/server.log 2>&1 &
SERVER_PID=$!

BACKEND_URL="http://localhost:3001"
MAX_RETRIES=30
RETRY_COUNT=0

# curlã‚³ãƒãƒ³ãƒ‰ã®å­˜åœ¨ç¢ºèª
if ! command -v curl > /dev/null 2>&1; then
  echo "âš  curlã‚³ãƒãƒ³ãƒ‰ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚å›ºå®šå¾…æ©Ÿæ™‚é–“ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚"
  sleep 5
else
  while [ $RETRY_COUNT -lt $MAX_RETRIES ]; do
    if curl -s -f "$BACKEND_URL" > /dev/null 2>&1; then
      echo "âœ… ã‚µãƒ¼ãƒãƒ¼ãŒèµ·å‹•ã—ã¾ã—ãŸ"
      break
    fi
    RETRY_COUNT=$((RETRY_COUNT + 1))
    if [ $((RETRY_COUNT % 5)) -eq 0 ]; then
      echo "  å¾…æ©Ÿä¸­... (${RETRY_COUNT}/${MAX_RETRIES})"
    fi
    sleep 1
  done

  if [ $RETRY_COUNT -eq $MAX_RETRIES ]; then
    echo "âŒ ã‚µãƒ¼ãƒãƒ¼ã®èµ·å‹•ã«å¤±æ•—ã—ã¾ã—ãŸï¼ˆã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆï¼‰"
    echo "ãƒ­ã‚°ã‚’ç¢ºèª: tail -20 /tmp/server.log"
    tail -20 /tmp/server.log 2>/dev/null || echo "ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“"
    kill $SERVER_PID 2>/dev/null || true
    exit 1
  fi
fi
```

### ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã¨ãƒ­ã‚°å‡ºåŠ›

**å¿…é ˆäº‹é …:**

1. **ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã¸ã®å‡ºåŠ›**: ã‚µãƒ¼ãƒãƒ¼ã®èµ·å‹•ãƒ­ã‚°ã‚’ãƒ•ã‚¡ã‚¤ãƒ«ã«å‡ºåŠ›ã—ã€ã‚¨ãƒ©ãƒ¼æ™‚ã«ç¢ºèªã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹
2. **ãƒ—ãƒ­ã‚»ã‚¹ã®é©åˆ‡ãªçµ‚äº†**: ãƒ†ã‚¹ãƒˆçµ‚äº†æ™‚ã«ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ãƒ—ãƒ­ã‚»ã‚¹ã‚’ç¢ºå®Ÿã«çµ‚äº†ã™ã‚‹
3. **çµ‚äº†ã‚³ãƒ¼ãƒ‰ã®ä¼æ’­**: ãƒ†ã‚¹ãƒˆã®çµ‚äº†ã‚³ãƒ¼ãƒ‰ã‚’é©åˆ‡ã«ä¼æ’­ã™ã‚‹

```bash
# ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã«å‡ºåŠ›
pnpm dev > /tmp/server.log 2>&1 &
SERVER_PID=$!

# ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
pnpm test:e2e
TEST_EXIT_CODE=$?

# ãƒ—ãƒ­ã‚»ã‚¹ã‚’çµ‚äº†
kill $SERVER_PID 2>/dev/null || true
wait $SERVER_PID 2>/dev/null || true

# çµ‚äº†ã‚³ãƒ¼ãƒ‰ã‚’ä¼æ’­
exit $TEST_EXIT_CODE
```

## ç’°å¢ƒå¤‰æ•°ã®ç®¡ç†

### ãƒãƒ¼ãƒˆç«¶åˆã®å›é¿

**âŒ æ‚ªã„ä¾‹ï¼ˆç’°å¢ƒå¤‰æ•°ã®ç«¶åˆï¼‰:**

```yaml
# CIè¨­å®š
env:
  PORT: 3001 # ã“ã‚ŒãŒNext.jsã«ã‚‚å½±éŸ¿ã—ã¦ã—ã¾ã†
```

```typescript
// Playwrightè¨­å®š
webServer: {
  command: 'pnpm dev',  // PORT=3001ãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹ã¨ã€Next.jsã‚‚3001ã‚’ä½¿ãŠã†ã¨ã™ã‚‹
  url: 'http://localhost:3000',
}
```

**âœ… è‰¯ã„ä¾‹ï¼ˆæ˜ç¤ºçš„ãªãƒãƒ¼ãƒˆæŒ‡å®šï¼‰:**

```yaml
# CIè¨­å®š
env:
  BACKEND_PORT: 3001 # ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰å°‚ç”¨
  FRONTEND_PORT: 3000 # ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰å°‚ç”¨
```

```typescript
// Playwrightè¨­å®š
webServer: [
  {
    command: 'pnpm --filter @account-book/backend dev',
    url: 'http://localhost:3001/api/health/institutions',
    env: {
      PORT: process.env.BACKEND_PORT || '3001', // æ˜ç¤ºçš„ã«æŒ‡å®š
    },
  },
  {
    command: 'pnpm dev',
    url: 'http://localhost:3000',
    env: {
      PORT: process.env.FRONTEND_PORT || '3000', // æ˜ç¤ºçš„ã«æŒ‡å®š
    },
  },
];
```

### ç’°å¢ƒå¤‰æ•°ã®å‘½åè¦å‰‡

- **ã‚µãƒ¼ãƒãƒ¼å›ºæœ‰ã®ç’°å¢ƒå¤‰æ•°**: `{SERVER}_PORT`, `{SERVER}_HOST`ãªã©ã®å½¢å¼ã‚’ä½¿ç”¨
- **å…±é€šã®ç’°å¢ƒå¤‰æ•°**: `NODE_ENV`, `ENCRYPTION_KEY`ãªã©ã¯æ˜ç¤ºçš„ã«è¨­å®š
- **ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã®æä¾›**: ç’°å¢ƒå¤‰æ•°ãŒè¨­å®šã•ã‚Œã¦ã„ãªã„å ´åˆã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã‚’æä¾›

## Playwrightã®webServerè¨­å®š

### è¤‡æ•°ã‚µãƒ¼ãƒãƒ¼ã®èµ·å‹•

**è¨­å®šä¾‹:**

```typescript
webServer: [
  // ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚µãƒ¼ãƒãƒ¼
  {
    command: 'pnpm --filter @account-book/backend dev',
    url: 'http://localhost:3001/api/health/institutions',
    reuseExistingServer: !process.env.CI,
    timeout: 120 * 1000,
    stdout: 'pipe',
    stderr: 'pipe',
    cwd: process.cwd(),
    env: {
      ENCRYPTION_KEY: process.env.ENCRYPTION_KEY || 'default-key',
      CRYPTO_SALT: process.env.CRYPTO_SALT || 'default-salt',
      NODE_ENV: process.env.NODE_ENV || 'development',
      PORT: process.env.BACKEND_PORT || '3001',
    },
  },
  // ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚µãƒ¼ãƒãƒ¼
  {
    command: 'pnpm dev',
    url: 'http://localhost:3000',
    reuseExistingServer: !process.env.CI,
    timeout: 120 * 1000,
    stdout: 'pipe',
    stderr: 'pipe',
    cwd: process.cwd(),
    env: {
      PORT: process.env.FRONTEND_PORT || '3000',
    },
  },
];
```

### é‡è¦ãªè¨­å®šé …ç›®

1. **`reuseExistingServer`**: CIç’°å¢ƒã§ã¯`false`ã€ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã§ã¯`true`ã«è¨­å®š
2. **`timeout`**: ã‚µãƒ¼ãƒãƒ¼èµ·å‹•ã®ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆï¼ˆ120ç§’ä»¥ä¸Šæ¨å¥¨ï¼‰
3. **`stdout`/`stderr`**: `'pipe'`ã«è¨­å®šã—ã¦ãƒ­ã‚°ã‚’å–å¾—å¯èƒ½ã«ã™ã‚‹
4. **`cwd`**: ä½œæ¥­ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’æ˜ç¤ºçš„ã«æŒ‡å®š
5. **`env`**: å¿…è¦ãªç’°å¢ƒå¤‰æ•°ã‚’æ˜ç¤ºçš„ã«è¨­å®š

## GitHub Actionsè¨­å®š

### CIå®Ÿè¡Œã®æœ€é©åŒ–

#### paths-ignoreã«ã‚ˆã‚‹ä¸è¦ãªCIå®Ÿè¡Œã®å›é¿

**ç›®çš„**: ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚„ã‚³ãƒ¡ãƒ³ãƒˆå¤‰æ›´ãªã©ã€ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã«å½±éŸ¿ã—ãªã„å¤‰æ›´æ™‚ã«CIã‚’ã‚¹ã‚­ãƒƒãƒ—ã™ã‚‹ã“ã¨ã§ã€ãƒªã‚½ãƒ¼ã‚¹ã‚’ç¯€ç´„ã—ã€ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’é«˜é€ŸåŒ–ã™ã‚‹ã€‚

**è¨­å®šä¾‹:**

```yaml
on:
  push:
    branches: [main, develop]
    paths-ignore: &paths-ignore
      - '**.md'
      - 'docs/**'
      - '.cursor/**/*.md'
      - '.cursorrules'
      - '.gitignore'
      - '.editorconfig'
  pull_request:
    branches: [main, develop]
    paths-ignore: *paths-ignore
```

**æ¨å¥¨ãƒ‘ã‚¿ãƒ¼ãƒ³:**

- `**.md`: ã™ã¹ã¦ã®ãƒãƒ¼ã‚¯ãƒ€ã‚¦ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«
- `docs/**`: ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå…¨ä½“
- `.cursor/**/*.md`: Cursorè¨­å®šå†…ã®ãƒãƒ¼ã‚¯ãƒ€ã‚¦ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«
- è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«: `.cursorrules`, `.gitignore`, `.editorconfig`ãªã©

**æ³¨æ„äº‹é …:**

- ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã«å½±éŸ¿ã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã¯å«ã‚ãªã„
- å¿…è¦ã«å¿œã˜ã¦ãƒ­ãƒ¼ã‚«ãƒ«ã§`pnpm build`ã¨`pnpm test`ã‚’å®Ÿè¡Œã—ã¦ã‹ã‚‰å¤‰æ›´ã‚’push

**ğŸ’¡ ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹:**

- **YAMLã‚¢ãƒ³ã‚«ãƒ¼ã®æ´»ç”¨**: `push`ã¨`pull_request`ã§åŒã˜è¨­å®šã‚’ä½¿ã†å ´åˆã¯ã€ã‚¢ãƒ³ã‚«ãƒ¼ï¼ˆ`&anchor`ï¼‰ã¨ã‚¨ã‚¤ãƒªã‚¢ã‚¹ï¼ˆ`*anchor`ï¼‰ã‚’ä½¿ç”¨ã—ã¦é‡è¤‡ã‚’å‰Šæ¸›ã™ã‚‹
- **ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹æ€§**: è¨­å®šã‚’ä¸€ç®‡æ‰€ã«ã¾ã¨ã‚ã‚‹ã“ã¨ã§ã€å¤‰æ›´æ™‚ã®ä¿®æ­£æ¼ã‚Œã‚’é˜²ã

**å­¦ç¿’å…ƒ**: Issue #267 - Geminiãƒ¬ãƒ“ãƒ¥ãƒ¼æŒ‡æ‘˜ã‚ˆã‚Š

#### timeout-minutesã«ã‚ˆã‚‹ç„¡é™ãƒ«ãƒ¼ãƒ—é˜²æ­¢

**ç›®çš„**: ç„¡é™ãƒ«ãƒ¼ãƒ—ã‚„äºˆæœŸã›ã¬é…å»¶ã«ã‚ˆã‚‹CIåœæ­¢ã‚’é˜²æ­¢ã—ã€GitHub Actionsä½¿ç”¨æ™‚é–“ã‚’ç®¡ç†ã™ã‚‹ã€‚

**è¨­å®šä¾‹:**

```yaml
jobs:
  lint:
    name: Lint
    runs-on: ubuntu-latest
    timeout-minutes: 10

  build:
    name: Build
    runs-on: ubuntu-latest
    timeout-minutes: 10

  test:
    name: Unit Tests
    runs-on: ubuntu-latest
    timeout-minutes: 10

  e2e-backend:
    name: E2E Tests (Backend)
    runs-on: ubuntu-latest
    timeout-minutes: 20

  e2e-frontend:
    name: E2E Tests (Frontend)
    runs-on: ubuntu-latest
    timeout-minutes: 20
```

**æ¨å¥¨å€¤:**

- é€šå¸¸ã®ã‚¸ãƒ§ãƒ–: `10åˆ†`
- E2Eãƒ†ã‚¹ãƒˆãªã©æ™‚é–“ãŒã‹ã‹ã‚‹ã‚¸ãƒ§ãƒ–: `15-20åˆ†`
- ãƒ“ãƒ«ãƒ‰ã‚¸ãƒ§ãƒ–: `10-15åˆ†`

**ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹:**

1. ã™ã¹ã¦ã®ã‚¸ãƒ§ãƒ–ã«`timeout-minutes`ã‚’è¨­å®šã™ã‚‹
2. å®Ÿéš›ã®å®Ÿè¡Œæ™‚é–“ã®2-3å€ã‚’ç›®å®‰ã«è¨­å®šã™ã‚‹
3. ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆç™ºç”Ÿæ™‚ã¯ãƒ­ã‚°ã‚’ç¢ºèªã—ã€åŸå› ã‚’ç‰¹å®šã™ã‚‹
4. **ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¨å®Ÿè£…ã®æ•´åˆæ€§**: æ¨å¥¨å€¤ã¨å®Ÿéš›ã®è¨­å®šä¾‹ãƒ»ci.ymlã®å€¤ãŒä¸€è‡´ã—ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã™ã‚‹

**ğŸ’¡ å­¦ç¿’ä¾‹**: Issue #267ã§ã¯ã€ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®æ¨å¥¨å€¤ï¼ˆE2Eãƒ†ã‚¹ãƒˆ: 15-20åˆ†ï¼‰ã¨è¨­å®šä¾‹ï¼ˆ10åˆ†ï¼‰ã«ä¸æ•´åˆãŒã‚ã‚Šã€Geminiãƒ¬ãƒ“ãƒ¥ãƒ¼ã§æŒ‡æ‘˜ã•ã‚Œã¾ã—ãŸã€‚ã“ã®ã‚ˆã†ãªä¸æ•´åˆã¯é–‹ç™ºè€…ã‚’æ··ä¹±ã•ã›ã‚‹ãŸã‚ã€ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆä½œæˆæ™‚ã¯å¿…ãšæ•´åˆæ€§ã‚’ç¢ºèªã—ã¾ã—ã‚‡ã†ã€‚

**å­¦ç¿’å…ƒ**: Issue #267 - Geminiãƒ¬ãƒ“ãƒ¥ãƒ¼æŒ‡æ‘˜ã‚ˆã‚Š

### ç’°å¢ƒå¤‰æ•°ã®è¨­å®š

```yaml
- name: Run Frontend E2E tests
  run: |
    cd apps/frontend
    pnpm test:e2e
  env:
    BASE_URL: http://localhost:3000
    # ã‚µãƒ¼ãƒãƒ¼å›ºæœ‰ã®ãƒãƒ¼ãƒˆã‚’åˆ†é›¢
    BACKEND_PORT: 3001
    FRONTEND_PORT: 3000
    # å…±é€šã®ç’°å¢ƒå¤‰æ•°
    ENCRYPTION_KEY: ${{ secrets.ENCRYPTION_KEY || 'default-key' }}
    CRYPTO_SALT: ${{ secrets.CRYPTO_SALT || 'default-salt' }}
    NODE_ENV: test
```

### ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

1. **æ‰‹å‹•èµ·å‹•ã®å‰Šé™¤**: Playwrightã®webServerè¨­å®šã‚’ä½¿ç”¨ã™ã‚‹å ´åˆã€æ‰‹å‹•ã§ã®ã‚µãƒ¼ãƒãƒ¼èµ·å‹•ã¯ä¸è¦
2. **ç’°å¢ƒå¤‰æ•°ã®åˆ†é›¢**: å„ã‚µãƒ¼ãƒãƒ¼ã§ä½¿ç”¨ã™ã‚‹ç’°å¢ƒå¤‰æ•°ã¯æ˜ç¢ºã«åˆ†é›¢ã™ã‚‹
3. **ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ã®ç¢ºèª**: ãƒ†ã‚¹ãƒˆå¤±æ•—æ™‚ã¯å¿…ãšã‚µãƒ¼ãƒãƒ¼ãƒ­ã‚°ã‚’ç¢ºèªã™ã‚‹

## ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

### ãƒ†ã‚¹ãƒˆã‚¹ã‚¯ãƒªãƒ—ãƒˆä½œæˆæ™‚

- [ ] å›ºå®šsleepã§ã¯ãªãã€ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ãƒ™ãƒ¼ã‚¹ã®å¾…æ©Ÿå‡¦ç†ã‚’å®Ÿè£…ã—ãŸ
- [ ] curlã‚³ãƒãƒ³ãƒ‰ã®å­˜åœ¨ç¢ºèªã¨ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯å‡¦ç†ã‚’è¿½åŠ ã—ãŸ
- [ ] ã‚µãƒ¼ãƒãƒ¼ãƒ­ã‚°ã‚’ãƒ•ã‚¡ã‚¤ãƒ«ã«å‡ºåŠ›ã—ã€ã‚¨ãƒ©ãƒ¼æ™‚ã«ç¢ºèªã§ãã‚‹ã‚ˆã†ã«ã—ãŸ
- [ ] ãƒ†ã‚¹ãƒˆçµ‚äº†æ™‚ã«ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ãƒ—ãƒ­ã‚»ã‚¹ã‚’ç¢ºå®Ÿã«çµ‚äº†ã™ã‚‹å‡¦ç†ã‚’è¿½åŠ ã—ãŸ
- [ ] ãƒ†ã‚¹ãƒˆã®çµ‚äº†ã‚³ãƒ¼ãƒ‰ã‚’é©åˆ‡ã«ä¼æ’­ã™ã‚‹ã‚ˆã†ã«ã—ãŸ

### CI/CDè¨­å®šæ™‚

- [ ] ãƒãƒ¼ãƒˆç«¶åˆã‚’é¿ã‘ã‚‹ãŸã‚ã€ã‚µãƒ¼ãƒãƒ¼å›ºæœ‰ã®ç’°å¢ƒå¤‰æ•°ã‚’ä½¿ç”¨ã—ãŸ
- [ ] Playwrightã®webServerè¨­å®šã§å¿…è¦ãªç’°å¢ƒå¤‰æ•°ã‚’æ˜ç¤ºçš„ã«è¨­å®šã—ãŸ
- [ ] ç’°å¢ƒå¤‰æ•°ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã‚’æä¾›ã—ãŸ
- [ ] `reuseExistingServer`ã‚’é©åˆ‡ã«è¨­å®šã—ãŸï¼ˆCI: false, ãƒ­ãƒ¼ã‚«ãƒ«: trueï¼‰
- [ ] ã™ã¹ã¦ã®ã‚¸ãƒ§ãƒ–ã«`timeout-minutes`ã‚’è¨­å®šã—ãŸ
- [ ] `paths-ignore`ã‚’ä½¿ç”¨ã—ã¦ä¸è¦ãªCIå®Ÿè¡Œã‚’å›é¿ã—ãŸ
- [ ] YAMLè¨­å®šã§é‡è¤‡ãŒã‚ã‚‹å ´åˆã¯ã€ã‚¢ãƒ³ã‚«ãƒ¼ã¨ã‚¨ã‚¤ãƒªã‚¢ã‚¹ã‚’ä½¿ç”¨ã—ãŸ
- [ ] ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®æ¨å¥¨å€¤ã¨å®Ÿéš›ã®è¨­å®šä¾‹ãƒ»ci.ymlã®å€¤ãŒä¸€è‡´ã—ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ãŸ

## å‚è€ƒè³‡æ–™

- [Playwright webServer Configuration](https://playwright.dev/docs/test-webserver)
- [GitHub Actions Environment Variables](https://docs.github.com/en/actions/learn-github-actions/environment-variables)

---

## ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆè¨˜è¿°ã®ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³

### CI/CDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆåŒ–

**åŸå‰‡**: CI/CDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã®èª¬æ˜ã§ã¯ã€**å…·ä½“æ€§ã¨ä¸€è²«æ€§**ã‚’é‡è¦–ã™ã‚‹ã“ã¨ã€‚

#### âŒ æ‚ªã„ä¾‹ï¼ˆæ›–æ˜§ãªè¡¨ç¾ï¼‰

```markdown
#### E2E Testsï¼ˆE2Eãƒ†ã‚¹ãƒˆï¼‰

- Backend E2Eãƒ†ã‚¹ãƒˆï¼ˆNestJSï¼‰
- Frontend E2Eãƒ†ã‚¹ãƒˆï¼ˆPlaywrightï¼‰
- å®Ÿéš›ã®MySQLç’°å¢ƒã§å®Ÿè¡Œ
```

**å•é¡Œç‚¹:**

- ã€Œå®Ÿéš›ã®MySQLç’°å¢ƒã€ãŒä½•ã‚’æŒ‡ã™ã®ã‹ä¸æ˜ç¢º
- ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆã¨ã®ä¸€è²«æ€§ãŒãªã„ï¼ˆãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆã§ã¯ã€ŒMySQL 8.0ã‚µãƒ¼ãƒ“ã‚¹ã‚³ãƒ³ãƒ†ãƒŠä½¿ç”¨ã€ã¨å…·ä½“çš„ã«è¨˜è¼‰ï¼‰
- é–‹ç™ºè€…ãŒç’°å¢ƒã‚’èª¤è§£ã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹

#### âœ… è‰¯ã„ä¾‹ï¼ˆå…·ä½“çš„ã§ä¸€è²«æ€§ã®ã‚ã‚‹è¡¨ç¾ï¼‰

```markdown
#### 3. Unit Testsï¼ˆãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆï¼‰

- ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã¨ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆ
- MySQL 8.0ã‚µãƒ¼ãƒ“ã‚¹ã‚³ãƒ³ãƒ†ãƒŠä½¿ç”¨
- ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸ãƒ¬ãƒãƒ¼ãƒˆã®Codecovã¸ã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰

#### 5. E2E Testsï¼ˆE2Eãƒ†ã‚¹ãƒˆï¼‰

- Backend E2Eãƒ†ã‚¹ãƒˆï¼ˆNestJSï¼‰
- Frontend E2Eãƒ†ã‚¹ãƒˆï¼ˆPlaywrightï¼‰
- MySQL 8.0ã‚µãƒ¼ãƒ“ã‚¹ã‚³ãƒ³ãƒ†ãƒŠã‚’ä½¿ç”¨ã—ã¦å®Ÿè¡Œ
```

**è‰¯ã„ç‚¹:**

- ä½¿ç”¨ã™ã‚‹ç’°å¢ƒãŒå…·ä½“çš„ï¼ˆMySQL 8.0ã‚µãƒ¼ãƒ“ã‚¹ã‚³ãƒ³ãƒ†ãƒŠï¼‰
- ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆã¨E2Eãƒ†ã‚¹ãƒˆã§è¨˜è¿°ã‚¹ã‚¿ã‚¤ãƒ«ãŒä¸€è²«ã—ã¦ã„ã‚‹
- é–‹ç™ºè€…ãŒç’°å¢ƒã‚’æ­£ç¢ºã«ç†è§£ã§ãã‚‹

### ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆè¨˜è¿°ã®ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

#### ç’°å¢ƒãƒ»ãƒ„ãƒ¼ãƒ«ã®è¨˜è¿°

- [ ] ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç•ªå·ã‚’æ˜è¨˜ã—ã¦ã„ã‚‹ï¼ˆä¾‹: MySQL 8.0ã€Node.js 20ï¼‰
- [ ] å®Ÿè¡Œç’°å¢ƒã®ç¨®é¡ã‚’æ˜ç¢ºã«ã—ã¦ã„ã‚‹ï¼ˆä¾‹: ã‚µãƒ¼ãƒ“ã‚¹ã‚³ãƒ³ãƒ†ãƒŠã€Dockerã€ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒï¼‰
- [ ] è¤‡æ•°ã®ç’°å¢ƒãŒé–¢é€£ã™ã‚‹å ´åˆã¯ã€ã™ã¹ã¦åˆ—æŒ™ã—ã¦ã„ã‚‹

#### ä¸€è²«æ€§ã®ç¢ºä¿

- [ ] åŒã˜ç¨®é¡ã®è¨˜è¿°ã§ã¯ã€åŒã˜è¡¨ç¾ã‚¹ã‚¿ã‚¤ãƒ«ã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹
- [ ] ç•¥èªã‚„ç”¨èªã¯çµ±ä¸€ã—ã¦ã„ã‚‹
- [ ] è©³ç´°åº¦ã®ãƒ¬ãƒ™ãƒ«ã‚’æƒãˆã¦ã„ã‚‹

#### å…·ä½“æ€§ã®ç¢ºä¿

- [ ] ã€Œå®Ÿéš›ã®ã€œã€ã€Œæœ¬ç•ªã®ã€œã€ãªã©ã®æ›–æ˜§ãªè¡¨ç¾ã‚’é¿ã‘ã¦ã„ã‚‹
- [ ] æŠ€è¡“çš„ãªç”¨èªã‚’æ­£ç¢ºã«ä½¿ç”¨ã—ã¦ã„ã‚‹
- [ ] ã€Œã©ã®ã‚ˆã†ã«ã€å®Ÿè¡Œã•ã‚Œã‚‹ã‹ãŒæ˜ç¢ºã§ã‚ã‚‹

### ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ›´æ–°æ™‚ã®æ³¨æ„ç‚¹

1. **æ—¢å­˜ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¨ã®æ•´åˆæ€§ç¢ºèª**: æ–°ã—ã„ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’è¿½åŠ ã™ã‚‹éš›ã¯ã€æ—¢å­˜ã®è¨˜è¿°ã‚¹ã‚¿ã‚¤ãƒ«ã¨ä¸€è²«æ€§ã‚’ä¿ã¤
2. **ãƒ¬ãƒ“ãƒ¥ãƒ¼è¦–ç‚¹ã®è€ƒæ…®**: ã€Œåˆã‚ã¦èª­ã‚€é–‹ç™ºè€…ãŒèª¤è§£ã—ãªã„ã‹ï¼Ÿã€ã‚’å¸¸ã«è€ƒãˆã‚‹
3. **å…·ä½“ä¾‹ã®æä¾›**: å¿…è¦ã«å¿œã˜ã¦ã€ã‚³ãƒãƒ³ãƒ‰ä¾‹ã‚„è¨­å®šä¾‹ã‚’è¿½åŠ ã™ã‚‹

### ä¾‹: README.mdã®CI/CDã‚»ã‚¯ã‚·ãƒ§ãƒ³

```markdown
## CI/CD

### CIãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³

`main`ã¾ãŸã¯`develop`ãƒ–ãƒ©ãƒ³ãƒã¸ã®pushã‚„Pull Requestæ™‚ã«ä»¥ä¸‹ãŒè‡ªå‹•å®Ÿè¡Œã•ã‚Œã¾ã™ï¼š

#### 1. Lintï¼ˆé™çš„è§£æï¼‰

- ESLintã«ã‚ˆã‚‹ã‚³ãƒ¼ãƒ‰ã‚¹ã‚¿ã‚¤ãƒ«ãƒã‚§ãƒƒã‚¯
- TypeScriptã®å‹ãƒã‚§ãƒƒã‚¯
- Node.js 20ã§å®Ÿè¡Œ

#### 2. Buildï¼ˆãƒ“ãƒ«ãƒ‰ãƒ†ã‚¹ãƒˆï¼‰

- å…±é€šãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ãƒ“ãƒ«ãƒ‰
- ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®ãƒ“ãƒ«ãƒ‰
- ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®ãƒ“ãƒ«ãƒ‰
- Node.js 20ã¨22ã®ãƒãƒˆãƒªãƒƒã‚¯ã‚¹ãƒ“ãƒ«ãƒ‰

#### 3. Unit Testsï¼ˆãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆï¼‰

- ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã¨ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆ
- MySQL 8.0ã‚µãƒ¼ãƒ“ã‚¹ã‚³ãƒ³ãƒ†ãƒŠä½¿ç”¨
- ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸ãƒ¬ãƒãƒ¼ãƒˆã®Codecovã¸ã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰

#### 4. Security Checkï¼ˆã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒã‚§ãƒƒã‚¯ï¼‰

- pnpm auditã«ã‚ˆã‚‹ä¾å­˜é–¢ä¿‚ã®è„†å¼±æ€§ã‚¹ã‚­ãƒ£ãƒ³
- è„†å¼±æ€§ãƒ¬ãƒãƒ¼ãƒˆã®ã‚¢ãƒ¼ãƒ†ã‚£ãƒ•ã‚¡ã‚¯ãƒˆä¿å­˜ï¼ˆ30æ—¥é–“ï¼‰

#### 5. E2E Testsï¼ˆE2Eãƒ†ã‚¹ãƒˆï¼‰

- Backend E2Eãƒ†ã‚¹ãƒˆï¼ˆNestJSï¼‰
- Frontend E2Eãƒ†ã‚¹ãƒˆï¼ˆPlaywrightï¼‰
- MySQL 8.0ã‚µãƒ¼ãƒ“ã‚¹ã‚³ãƒ³ãƒ†ãƒŠã‚’ä½¿ç”¨ã—ã¦å®Ÿè¡Œ
```

**è¨˜è¿°ã®ãƒã‚¤ãƒ³ãƒˆ:**

- å„ã‚¸ãƒ§ãƒ–ã®ç›®çš„ãŒæ˜ç¢º
- ä½¿ç”¨ã™ã‚‹ç’°å¢ƒãƒ»ãƒ„ãƒ¼ãƒ«ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒæ˜è¨˜ã•ã‚Œã¦ã„ã‚‹
- è¨˜è¿°ã‚¹ã‚¿ã‚¤ãƒ«ãŒçµ±ä¸€ã•ã‚Œã¦ã„ã‚‹
- å°‚é–€ç”¨èªãŒæ­£ç¢ºã«ä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹

---

## ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ¸¬å®šã¨ãƒ†ã‚¹ãƒˆã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

### ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ¸¬å®šã®ç²¾åº¦å‘ä¸Š ğŸŸ  High

**å­¦ç¿’å…ƒ**: PR #259 - ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆã¨ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°

#### âŒ æ‚ªã„ä¾‹: Date.now()ã®ä½¿ç”¨

```typescript
const startTime = Date.now();
await someOperation();
const duration = Date.now() - startTime;
```

**å•é¡Œç‚¹**:

- ãƒŸãƒªç§’å˜ä½ã®ç²¾åº¦ã—ã‹ãªã„
- ã‚·ã‚¹ãƒ†ãƒ ã‚¯ãƒ­ãƒƒã‚¯ã®å¤‰æ›´ã«å½±éŸ¿ã‚’å—ã‘ã‚‹
- çŸ­ã„å‡¦ç†æ™‚é–“ã®æ¸¬å®šã«ã¯ä¸ååˆ†

#### â–³ è‰¯ã„ä¾‹: performance.now()ã®ä½¿ç”¨

```typescript
import { performance } from 'perf_hooks';

const startTime = performance.now();
await someOperation();
const duration = performance.now() - startTime;
```

**åˆ©ç‚¹**:

- ãƒã‚¤ã‚¯ãƒ­ç§’å˜ä½ã®ç²¾åº¦
- å˜èª¿å¢—åŠ ãŒä¿è¨¼
- ã‚·ã‚¹ãƒ†ãƒ ã‚¯ãƒ­ãƒƒã‚¯ã®å¤‰æ›´ã«å½±éŸ¿ã•ã‚Œãªã„

#### âœ… æœ€è‰¯ã®ä¾‹: process.hrtime.bigint()ã®ä½¿ç”¨

```typescript
// ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°ã‚’å®šç¾©
function measureTime(startTime: bigint): number {
  return Number(process.hrtime.bigint() - startTime) / 1_000_000;
}

// ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰
const startTime = process.hrtime.bigint();
await someOperation();
const duration = measureTime(startTime);
```

**åˆ©ç‚¹**:

- ãƒŠãƒç§’å˜ä½ã®é«˜ç²¾åº¦è¨ˆæ¸¬
- BigIntå‹ã§ç²¾åº¦ã®æå¤±ãªã—
- çŸ­ã„ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚¿ã‚¤ãƒ ã‚‚æ­£ç¢ºã«æ¸¬å®šå¯èƒ½
- å˜èª¿å¢—åŠ ãŒä¿è¨¼

---

### éåŒæœŸå‡¦ç†ã®å¾…æ©Ÿãƒ­ã‚¸ãƒƒã‚¯ ğŸŸ¡ Medium

#### âŒ æ‚ªã„ä¾‹: å›ºå®šæ™‚é–“ã®sleep

```bash
start-database.sh
sleep 5  # å›ºå®š5ç§’å¾…æ©Ÿ
```

**å•é¡Œç‚¹**:

- ç’°å¢ƒã«ã‚ˆã£ã¦èµ·å‹•æ™‚é–“ãŒç•°ãªã‚‹
- 5ç§’ã§è¶³ã‚Šãªã„å ´åˆãŒã‚ã‚‹
- å¿…è¦ä»¥ä¸Šã«å¾…æ©Ÿã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹

#### âœ… è‰¯ã„ä¾‹: ãƒãƒ¼ãƒªãƒ³ã‚°ï¼‹ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ

```bash
max_wait=30
waited=0
while ! nc -z localhost 3306 2>/dev/null && [ $waited -lt $max_wait ]; do
  sleep 1
  waited=$((waited + 1))
  echo -n "."
done

if [ $waited -ge $max_wait ]; then
  echo "Failed to start within ${max_wait} seconds"
  exit 1
fi
```

**åˆ©ç‚¹**:

- èµ·å‹•å®Œäº†æ¬¡ç¬¬å³åº§ã«é€²è¡Œ
- ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã§ç„¡é™å¾…æ©Ÿã‚’é˜²æ­¢
- CIç’°å¢ƒã§ã®å®‰å®šæ€§å‘ä¸Š

---

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ ğŸŸ¡ Medium

#### âŒ æ‚ªã„ä¾‹: å›ºå®šæ™‚é–“å¾…æ©Ÿ

```typescript
// Core Web Vitalså–å¾—
setTimeout(() => {
  resolve(metrics);
}, 3000); // å¸¸ã«3ç§’å¾…æ©Ÿ
```

**å•é¡Œç‚¹**:

- ãƒ¡ãƒˆãƒªã‚¯ã‚¹ãŒæ—©ãå–å¾—ã§ãã¦ã‚‚3ç§’å¾…æ©Ÿ
- 3ç§’ã§å–å¾—ã§ããªã„å ´åˆã‚‚ã‚ã‚‹
- ãƒ†ã‚¹ãƒˆå®Ÿè¡Œæ™‚é–“ã®ç„¡é§„

#### âœ… è‰¯ã„ä¾‹: ãƒãƒ¼ãƒªãƒ³ã‚°ï¼‹ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ

```typescript
const pollInterval = setInterval(() => {
  if (fcpCaptured && lcpCaptured) {
    clearInterval(pollInterval);
    clearTimeout(timeoutId);
    resolve(metrics);
  }
}, 100);

const timeoutId = setTimeout(() => {
  clearInterval(pollInterval);
  resolve(metrics); // éƒ¨åˆ†çš„ãªçµæœã§ã‚‚è¿”ã™
}, 5000);
```

**åˆ©ç‚¹**:

- å–å¾—å®Œäº†æ¬¡ç¬¬å³åº§ã«é€²è¡Œ
- ãƒ†ã‚¹ãƒˆå®Ÿè¡Œé€Ÿåº¦ã®å‘ä¸Š
- ä¿¡é ¼æ€§ã®å‘ä¸Š

---

### ãƒ¬ã‚¬ã‚·ãƒ¼APIã®ä½¿ç”¨å›é¿ ğŸŸ¡ Medium

#### âŒ æ‚ªã„ä¾‹: window.performance.timing

```typescript
const perfData = window.performance.timing;
const duration = perfData.loadEventEnd - perfData.navigationStart;
```

**å•é¡Œç‚¹**:

- éæ¨å¥¨APIï¼ˆå°†æ¥å‰Šé™¤ã•ã‚Œã‚‹å¯èƒ½æ€§ï¼‰
- ç²¾åº¦ãŒä½ã„

#### âœ… è‰¯ã„ä¾‹: Navigation Timing API Level 2

```typescript
const navigation = performance.getEntriesByType('navigation')[0] as PerformanceNavigationTiming;
const duration = navigation.loadEventEnd - navigation.loadEventStart;
```

**åˆ©ç‚¹**:

- æœ€æ–°ã®æ¨™æº–API
- ã‚ˆã‚Šè©³ç´°ãªãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’å–å¾—å¯èƒ½
- å°†æ¥çš„ãªäº’æ›æ€§ãŒä¿è¨¼ã•ã‚Œã¦ã„ã‚‹

---

### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ†ã‚¹ãƒˆã®å®Ÿç”¨æ€§ ğŸŸ  High

#### âŒ æ‚ªã„ä¾‹: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ãªã„ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ

```typescript
describe('Database Connection Pool Performance', () => {
  it('should manage pool efficiently', async () => {
    // /api/healthã¯DBã«ã‚¢ã‚¯ã‚»ã‚¹ã—ãªã„ãŸã‚ã€ã‚³ãƒã‚¯ã‚·ãƒ§ãƒ³ãƒ—ãƒ¼ãƒ«ã‚’æ¸¬å®šã§ããªã„
    const requests = Array.from({ length: 30 }, () => request(app).get('/api/health'));
    await Promise.all(requests);
  });
});
```

**å•é¡Œç‚¹**:

- ã‚³ãƒã‚¯ã‚·ãƒ§ãƒ³ãƒ—ãƒ¼ãƒ«ã®è² è·ã‚’æ¸¬å®šã§ããªã„
- ãƒ†ã‚¹ãƒˆåã¨å®Ÿéš›ã®æ¸¬å®šå†…å®¹ãŒä¹–é›¢
- å®Ÿç”¨çš„ã§ãªã„ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ

#### âœ… è‰¯ã„ä¾‹: å®Ÿéš›ã«DBã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ

```typescript
describe('Database Connection Pool Performance', () => {
  it('should manage pool efficiently', async () => {
    // ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’æº–å‚™
    await seedTestData();

    // /api/institutionsã¯å®Ÿéš›ã«DBã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹
    const requests = Array.from({ length: 30 }, () => request(app).get('/api/institutions'));
    const startTime = process.hrtime.bigint();
    await Promise.all(requests);
    const duration = measureTime(startTime);

    // ã‚³ãƒã‚¯ã‚·ãƒ§ãƒ³ãƒ—ãƒ¼ãƒ«ã®åŠ¹ç‡ã‚’æ­£ç¢ºã«æ¸¬å®šã§ãã‚‹
    expect(duration).toBeLessThan(3000);
  });
});
```

**åˆ©ç‚¹**:

- å®Ÿéš›ã®DBã‚¢ã‚¯ã‚»ã‚¹ã§æ­£ç¢ºãªæ¸¬å®š
- ã‚³ãƒã‚¯ã‚·ãƒ§ãƒ³ãƒ—ãƒ¼ãƒ«ã®è² è·ã‚’é©åˆ‡ã«è©•ä¾¡
- å®Ÿé‹ç”¨ã«è¿‘ã„æ¡ä»¶ã§ã®ãƒ†ã‚¹ãƒˆ

---

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ†ã‚¹ãƒˆã®å …ç‰¢æ€§ ğŸŸ¡ Medium

#### âŒ æ‚ªã„ä¾‹: å›ºå®šæ™‚é–“å¾…æ©Ÿ

```typescript
test('Button clicks should respond quickly', async ({ page }) => {
  await buttons[0].click();
  await page.waitForTimeout(100); // å›ºå®š100mså¾…æ©Ÿ
  const duration = Date.now() - startTime;
});
```

**å•é¡Œç‚¹**:

- ãƒ•ãƒ¬ãƒ¼ã‚­ãƒ¼ãƒ†ã‚¹ãƒˆï¼ˆä¸å®‰å®šãªãƒ†ã‚¹ãƒˆï¼‰ã®åŸå› 
- ç’°å¢ƒã«ã‚ˆã£ã¦å‹•ä½œãŒå¤‰ã‚ã‚‹
- ã‚¯ãƒªãƒƒã‚¯å¾Œã®å¤‰åŒ–ã‚’æ­£ã—ãå¾…æ©Ÿã—ã¦ã„ãªã„

#### âœ… è‰¯ã„ä¾‹: ã‚¤ãƒ™ãƒ³ãƒˆãƒ™ãƒ¼ã‚¹ã®å¾…æ©Ÿ

```typescript
import { performance } from 'perf_hooks';

test('Button clicks should respond quickly', async ({ page }) => {
  const startTime = performance.now();
  await buttons[0].click();
  // å…·ä½“çš„ãªå¤‰åŒ–ï¼ˆãƒ¢ãƒ¼ãƒ€ãƒ«è¡¨ç¤ºãªã©ï¼‰ã‚’å¾…ã¤
  await page.waitForSelector('.modal-dialog', {
    state: 'visible',
    timeout: 500,
  });
  const duration = performance.now() - startTime;
});
```

**åˆ©ç‚¹**:

- ãƒ†ã‚¹ãƒˆã®å …ç‰¢æ€§å‘ä¸Š
- å…·ä½“çš„ãªå¤‰åŒ–ã‚’å¾…ã¤ã“ã¨ã§æ„å›³ãŒæ˜ç¢º
- ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã§ç„¡é™å¾…æ©Ÿã‚’é˜²æ­¢

---

### CI/CDè¨­å®šã®æœ€æ–°åŒ– ğŸŸ¡ Medium

#### âŒ æ‚ªã„ä¾‹: å¤ã„ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒãƒ¼ã‚¸ãƒ§ãƒ³

```yaml
- uses: actions/checkout@v3
- uses: actions/setup-node@v3
- uses: actions/upload-artifact@v3
```

#### âœ… è‰¯ã„ä¾‹: æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®ä½¿ç”¨

```yaml
- uses: actions/checkout@v4
- uses: actions/setup-node@v4
- uses: actions/upload-artifact@v4
  with:
    if-no-files-found: ignore # ãƒ•ã‚¡ã‚¤ãƒ«ãŒãªã„å ´åˆã‚‚ç¶™ç¶š
```

**åˆ©ç‚¹**:

- ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã®é©ç”¨
- æ–°æ©Ÿèƒ½ã®åˆ©ç”¨
- å°†æ¥çš„ãªäº’æ›æ€§ã®ç¢ºä¿

---

### è¨ˆæ¸¬ç²¾åº¦ã®é€²åŒ–

```
Date.now() â†’ performance.now() â†’ process.hrtime.bigint()
   â†“              â†“                    â†“
ãƒŸãƒªç§’         ãƒã‚¤ã‚¯ãƒ­ç§’           ãƒŠãƒç§’
```

---
